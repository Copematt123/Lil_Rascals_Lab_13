---
title: "Lab_13"
author: "Lil Rascals"
date: "April 17, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(cowplot)
library(stringr)
library(gapminder)
```
### Overall Question: What does world health look like?

#### Specific Question Kelsey
How much has health specifically smoking in women improved over a few years and by country? Is it better in the US than other countries? 
```{r}
library(tidyverse)
library(dplyr)
library(lubridate)
library(stringr)
library(gapminder)
library(forcats)
library(cowplot)
smoke <- read_csv("smoking_women.csv")
  cont2 <- smoke %>% filter(year==2005) %>% select(percent)

    other <- sample(cont2$percent, 20, replace = FALSE)
smoke<-na.omit(smoke) %>% gather('2000', '2002','2005', key = "year", value = "percent")
smokepercent <- function(perms = 1000, year1,country1, n1 ){


  mean_mat <- matrix(0,1000,1)
  for (i in c(1:perms))
  {

    cont1 <- smoke %>% filter(country==country1, year==year1) 
    cont2 <- smoke %>% filter(year==year1) 
    other <- sample(cont2$percent, n1, replace = FALSE)

    A <- mean(cont1$percent)
    B <- mean(other)
    mean_mat[[i]] <- (A-B)
  }
  return(mean_mat)
}

rsample <- as.tibble(smokepercent(perms = 1000,year1=2005,country1="United States",n1=10))

cont3 <- smoke %>% filter(year==2005, country=="United States") %>% select(percent)
cont4 <- smoke %>% filter(year==2005) %>% select(percent)
smoke1 <- summary(cont3$percent)
smoke2 <- summary(cont4$percent)
diff <- median(cont3$percent)- median(cont4$percent)

std <- sqrt( (sd(cont4$percent))^2/length(cont4$percent))
z_score <- diff/std
z_score

ggplot(rsample, aes(x=V1 ))+geom_histogram()+
  xlab("Means")+
  geom_vline(xintercept = diff, color = "red", size = .3)+
  ylab("Number")+
  ggtitle("Difference in Means in Women Smoking in 2005")

```





